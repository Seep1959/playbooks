- name: Do apt stuff
  include: tasks/install_apt.yml
  when: ansible_pkg_mgr == "apt"

- name: Installing lame
  package: name=lame state=present

- name: Creating Subsonic group
  group: name=subsonic state=present gid=80

- name: Creating Subsonic user
  user: name=subsonic uid=80 group=subsonic

- name: Stop subsonic
  service: name=subsonic state=stopped
- name: Update subsonic config context
  lineinfile: dest=/etc/default/subsonic regexp=^SUBSONIC_ARGS= line=SUBSONIC_ARGS="--max-memory=150 --context-path=/subsonic"
- name: Update subsonic config user
  lineinfile: dest=/etc/default/subsonic regexp=^SUBSONIC_USER= line=SUBSONIC_USER=subsonic
- name: Enable subsonic
  service: name=subsonic state=running enabled=yes
